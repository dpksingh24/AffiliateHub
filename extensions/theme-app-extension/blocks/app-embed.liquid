{% assign pricing_rules_metafield = shop.metafields.kiscience.pricing_rules %}

<script id="kiscience-config" type="application/json">
{
  "shop": "{{ shop.permanent_domain }}",
  "appApiBaseUrl": "https://kisciapp.ebizonstg.com",
  "customerId": {% if customer %}"{{ customer.id }}"{% else %}null{% endif %},
  "customerLoggedIn": {% if customer %}true{% else %}false{% endif %},
  "customerTags": {% if customer %}{{ customer.tags | json }}{% else %}[]{% endif %},
  "currency": "{{ cart.currency.iso_code | default: shop.currency }}"
}
</script>

<script src="{{ 'shared-cart-landing.js' | asset_url }}" defer></script>

{% if pricing_rules_metafield != blank %}
<script id="kiscience-rules" type="application/json">
{{ pricing_rules_metafield }}
</script>
{% endif %}

<link rel="stylesheet" href="{{ 'custom-pricing.css' | asset_url }}">
<script src="{{ 'custom-pricing.js' | asset_url }}" defer></script>

{% schema %} {
  "name": "Kiscience Custom Pricing",
  "target": "head",
  "settings": [
    {
      "type": "checkbox",
      "id": "enabled",
      "label": "Enable Custom Pricing",
      "default": true,
      "info": "Automatically applies custom pricing to product pages based on your pricing rules"
    }
  ]
}
{% endschema %}
